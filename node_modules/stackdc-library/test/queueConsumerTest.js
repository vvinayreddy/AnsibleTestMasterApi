var queueConsumer = require('../').queueConsumer;

var test_topic = 'workflow-test-5'


var consumer = new queueConsumer({
    url: 'amqp://localhost',
    durable: false,
    queue: test_topic,
    ack: false,
    retryTimeOut: 25
});

consumer.onMessage(function (message, channel) {
    console.log('message:', JSON.parse(message.content));
    //console.log('message:', message);

    if (channel) {
        console.log('Acknowledging the message')
        channel.ack(message)
    }
});

consumer.onError(function (error) {
    console.log(error);
});

console.log('test completed.. waiting for cleanup')
setTimeout(function () {
        console.log('waiting done')
    },
    60000);