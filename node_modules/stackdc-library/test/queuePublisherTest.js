var queuePublisher = require('../').queuePublisher;

var test_topic = 'workflow-test-5'


var publisher = new queuePublisher({
    url: 'amqp://localhost',
    durable: true,
    ack: true
});

testMessage('*****Hello1');

setTimeout(function () {
       testMessage('******Hello2');
    },
    1500);
 setTimeout(function () {
       testMessage('******Hello3');
    },
    25000);   
  setTimeout(function () {
       testMessage('*****Hello4');
    },
    30000);   


function testMessage(msg) {
    publisher.publishMessage(
        test_topic, {
            user: 'stackdc',
            type: msg,
            action: 'execute'
        }, {
           msg:msg
        },
        function (err, res) {
            if (err) {
                console.log('Error in Test message:' + err);

            } else {
                console.log('Result:' + res);
            }

        })
};